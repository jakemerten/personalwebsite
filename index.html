<!DOCTYPE html>
<html lang="en" class="dark">
<head>
            <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DPR9L83Q39"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DPR9L83Q39');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jake Merten | Portfolio</title>
    <link rel="icon" type="image/x-icon" href="/images/mountain.png">
    <!-- Load Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Poppins (A geometric font similar to Sofia Pro) -->
    <style>
        /* Changed from Source Sans 3 to Poppins */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap');
        body {
            font-family: 'Poppins', sans-serif; /* Updated font to Poppins */
            /* Setting a light weight (300) to maintain the "fragile" appearance */
            font-weight: 300; 
            transition: background-color 0.3s, color 0.3s;
        }
        /* Custom styles for the theme toggle icon */
        .theme-icon {
            display: inline-block;
            transition: transform 0.3s ease-in-out;
        }
        .rotated {
            transform: rotate(360deg);
        }
        /* Ensure specific elements use the correct weight */
        h1, h2, h3, a.font-semibold {
            /* H1 is overridden inline below, but H2/H3 remain bold for section visibility */
            font-weight: 700; 
        }
        .font-medium {
            font-weight: 500;
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class', // Enable dark mode based on the 'dark' class on the HTML tag
            theme: {
                extend: {
                    colors: {
                        'primary-dark': '#1A1A1A',
                        'secondary-dark': '#242424',
                        'text-light': '#F3F4F6',
                        'text-dark': '#D1D5DB',
                        // Dark Burnt Orange Accents
                        'accent': '#C54E20', 
                        'accent-darker': '#A6411A', 
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-white dark:bg-primary-dark text-gray-800 dark:text-text-dark min-h-screen">

    <!-- Header / Navigation Bar -->
    <header class="sticky top-0 z-10 w-full p-4 bg-white/90 dark:bg-primary-dark/90 backdrop-blur-sm shadow-sm dark:shadow-secondary-dark/50 border-b border-gray-100 dark:border-secondary-dark/50">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <!-- Logo/Name -->
            <a href="#" class="text-xl font-semibold text-accent hover:text-accent-darker rounded-lg p-2 transition duration-200">
                &lt;JM/&gt;
            </a>
            
            <!-- Navigation Links -->
            <nav class="hidden md:flex space-x-6 items-center">
                <a href="#about" class="text-gray-700 dark:text-text-dark hover:text-accent dark:hover:text-accent-darker font-medium transition duration-200">About</a>
                <a href="#projects" class="text-gray-700 dark:text-text-dark hover:text-accent dark:hover:text-accent-darker font-medium transition duration-200">Projects</a>
                <a href="#posts" class="text-gray-700 dark:text-text-dark hover:text-accent dark:hover:text-accent-darker font-medium transition duration-200">Posts</a>
                <a href="#contact" class="text-gray-700 dark:text-text-dark hover:text-accent dark:hover:text-accent-darker font-medium transition duration-200">Contact</a>
            </nav>

            <!-- Theme Toggle Button (Moon/Sun Icon) -->
            <button id="theme-toggle" aria-label="Toggle theme" class="p-2 ml-4 text-gray-700 dark:text-text-dark bg-gray-100 dark:bg-secondary-dark rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition duration-300 shadow-md">
                <!-- Moon icon (default in dark mode) -->
                <svg id="moon-icon" class="theme-icon w-6 h-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9 9.003 9.003 0 008.354-5.646z" />
                </svg>
                <!-- Sun icon (default in light mode) -->
                <svg id="sun-icon" class="theme-icon w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
            </button>
        </div>
    </header>

    <!-- Mobile Navigation Menu (Hidden by default) -->
    <div id="mobile-menu" class="md:hidden p-4 bg-white dark:bg-secondary-dark border-t border-gray-200 dark:border-gray-700 hidden">
        <nav class="flex flex-col space-y-2">
            <a href="#about" class="py-2 text-gray-700 dark:text-text-dark hover:text-accent dark:hover:text-accent-darker font-medium transition duration-200 rounded-md px-3">About</a>
            <a href="#projects" class="py-2 text-gray-700 dark:text-text-dark hover:text-accent dark:hover:text-accent-darker font-medium transition duration-200 rounded-md px-3">Projects</a>
            <a href="#posts" class="py-2 text-gray-700 dark:text-text-dark hover:text-accent dark:hover:text-accent-darker font-medium transition duration-200 rounded-md px-3">Posts</a>
            <a href="#contact" class="py-2 text-gray-700 dark:text-text-dark hover:text-accent dark:hover:text-accent-darker font-medium transition duration-200 rounded-md px-3">Contact</a>
        </nav>
    </div>

    <main class="max-w-6xl mx-auto px-4 py-16 sm:py-24">
        
        <!-- Hero/Intro Section (Simulating the main landing page content) -->
        <section id="about" class="min-h-[50vh] flex flex-col justify-center items-center text-center">
            
            <!-- Profile Image -->
            <div class="relative w-32 h-32 mb-8 bg-gray-200 dark:bg-secondary-dark rounded-full overflow-hidden shadow-xl border-4 border-accent/50">
                <img src="images/self.jpg" 
                    alt="Jake Merten Profile Picture" 
                    class="w-full h-full object-cover"
                    onerror="this.onerror=null; this.src='https://placehold.co/128x128/374151/FFFFFF?text=JM'">
            </div>

            <!-- Reduced text size for minimalist look -->
            <h1 class="text-2xl sm:text-3xl font-light text-gray-900 dark:text-text-light mb-4 leading-tight">
                <span class="text-accent">Jake Merten</span>
            </h1>
            <!-- Reduced text size for minimalist look -->
            <p class="text-lg sm:text-xl text-gray-600 dark:text-gray-400 mb-8 max-w-2xl">
                Software Engineer & Environmental Scientist
            </p>
            
            <!-- Social Icons (using inline SVG for simplicity) -->
            <div class="flex space-x-6">
                <!-- GitHub -->
                <a href="https://github.com/jakemerten" target="_blank" rel="noopener noreferrer" aria-label="GitHub Profile"
                   class="p-2 rounded-full hover:bg-secondary-dark/50 transition duration-200 text-gray-600 dark:text-gray-400 hover:text-accent dark:hover:text-accent-darker">
                    <svg class="w-7 h-7" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.385 3.456 9.914 8.24 11.432.6.11.82-.26.82-.577 0-.285-.01-1.04-.015-2.04-3.344.726-4.04-1.61-4.04-1.61-.546-1.387-1.334-1.756-1.334-1.756-1.09-.745.082-.73.082-.73 1.205.085 1.838 1.238 1.838 1.238 1.07 1.835 2.809 1.305 3.493.998.108-.775.419-1.305.762-1.604-2.665-.304-5.466-1.332-5.466-5.93 0-1.31.467-2.38.12-3.218-.12-.303.535-1.58.125-3.155 0 0 1.002-.32 3.275 1.23.948-.263 1.954-.394 2.97-.398 1.015.004 2.02.135 2.97.398 2.275-1.55 3.273-1.23 3.273-1.23.41 1.575.02 2.852-.12 3.155-.34 0-.12.467 0 1.31 0 4.588-2.802 5.623-5.474 5.92-.429.37-.82 1.106-.82 2.227 0 1.604-.015 2.894-.015 3.284 0 .32.22.69.825.57C19.539 21.905 24 17.382 24 12 24 5.373 18.627 0 12 0z"/></svg>
                </a>
                
                <!-- LinkedIn (Placeholder) -->
                <a href="https://www.linkedin.com/in/jakemerten/" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn Profile"
                   class="p-2 rounded-full hover:bg-secondary-dark/50 transition duration-200 text-gray-600 dark:text-gray-400 hover:text-accent dark:hover:text-accent-darker">
                    <svg class="w-7 h-7" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.364-4-3.57-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.234 7 3.321v5.914z"/></svg>
                </a>

                <!-- Email (Placeholder) -->
                <a href="mailto:jakemer10@gmail.com" target=”_blank” rel=noopener noreferrer”” aria-label="Email Contact"
                   class="p-2 rounded-full hover:bg-secondary-dark/50 transition duration-200 text-gray-600 dark:text-gray-400 hover:text-accent dark:hover:text-accent-darker">
                    <svg class="w-7 h-7" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12.713l-11.75-8.834h23.5l-11.75 8.834zm0 2.287l-12-9v16h24v-16l-12 9z"/></svg>
                </a>
            </div>
        </section>

        <!-- Dynamic Projects Section -->
        <section id="projects" class="pt-24 pb-16 border-t border-gray-200 dark:border-secondary-dark/50 mt-16">
            <h2 class="text-2xl font text-gray-900 dark:text-text-light mb-6">Featured Projects</h2>
            
            <!-- Filter Buttons Container (Dynamic) -->
            <div id="filter-buttons" class="flex flex-wrap gap-2 mb-8">
                <!-- Buttons will be dynamically inserted here by JavaScript -->
                <button class="px-4 py-2 text-sm rounded-full bg-gray-100 dark:bg-secondary-dark text-gray-700 dark:text-text-dark font-medium transition duration-200 shadow-md">Loading Filters...</button>
            </div>

            <!-- Project Grid Container (Dynamic) -->
            <div id="projects-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Initial loading state -->
                <div class="p-6 text-center bg-gray-50 dark:bg-secondary-dark/70 rounded-xl shadow-lg col-span-1 md:col-span-2 text-gray-500 dark:text-gray-400">
                    Fetching projects from GitHub...
                </div>
            </div>
        </section>

        <!-- Latest Posts Section - Now dynamically loaded by JavaScript -->
        <section id="posts" class="pt-24 pb-16 border-t border-gray-200 dark:border-secondary-dark/50">
            <h2 class="text-2xl font text-gray-900 dark:text-text-light mb-6">Latest Posts</h2>
            
            <!-- This UL will be populated by the JavaScript fetch function -->
            <ul id="medium-posts-list" class="space-y-4">
                <!-- Initial loading state -->
                <li class="p-4 bg-gray-50 dark:bg-secondary-dark/70 rounded-lg text-gray-500 dark:text-gray-400 italic">
                    Loading posts from Medium...
                </li>
            </ul>
        </section>

        <section id="contact" class="pt-20 pb-16 border-t border-gray-200 dark:border-secondary-dark/50">
            <h2 class="text-2xl font text-gray-900 dark:text-text-light mb-6">Contact</h2>
            <p class="text-lg text-gray-600 dark:text-gray-400 max-w-xl">
                Feel free to connect with me on LinkedIn or send me an email directly.
            </p>
            <a href="mailto:jakemer10@gmail.com" target="_blank" rel="noopener noreferrer" class="mt-4 inline-block px-6 py-3 bg-accent text-text-light font-bold rounded-lg shadow-md hover:bg-accent-darker transition duration-300">
            Email Me
            </a>
        </section>

    </main>

    <!-- Footer -->
    <footer class="mt-16 py-8 border-t border-gray-200 dark:border-secondary-dark/50 text-center text-sm text-gray-500 dark:text-gray-500">
        <p>&copy; <span id="current-year"></span> Jake Merten. All rights reserved. | Built with Tailwind CSS.</p>
    </footer>

    <!-- JavaScript for Theme Toggle and Initialization -->
    <script>
        const htmlElement = document.documentElement;
        const themeToggle = document.getElementById('theme-toggle');
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');
        const currentYearSpan = document.getElementById('current-year');
        const postsList = document.getElementById('medium-posts-list');
        // New variables for Projects section
        const projectsGrid = document.getElementById('projects-grid');
        const filterButtonsContainer = document.getElementById('filter-buttons');
        
        // Define the constant for the feature tag
        const FEATURE_TAG = 'portfolio-feature'; 
        // Define the constant for the custom title prefix (NOW GITHUB COMPLIANT)
        const TITLE_PREFIX = 'proj-title-'; // Must start with lowercase letter/number and use no special characters

        // --- Theme Toggle Logic (Existing) ---
        
        // Set current year in footer
        currentYearSpan.textContent = new Date().getFullYear();

        // 1. Initial Load: Check localStorage for theme preference
function initTheme() {
    const savedTheme = localStorage.getItem('theme');
    
    // Check ONLY if the user explicitly saved 'light'
    if (savedTheme === 'light') {
        // Apply light theme
        htmlElement.classList.remove('dark');
        updateIcons('light');
    } else {
        // If savedTheme is 'dark' OR if there is NO savedTheme, apply dark theme.
        htmlElement.classList.add('dark');
        updateIcons('dark');
    }
}

        // 2. Icon Switching Logic
        function updateIcons(theme) {
            if (theme === 'dark') {
                moonIcon.classList.remove('hidden');
                sunIcon.classList.add('hidden');
            } else {
                moonIcon.classList.add('hidden');
                sunIcon.classList.remove('hidden');
            }
        }

        // 3. Toggle Functionality
        function toggleTheme() {
            // Apply rotation animation to the currently visible icon
            const activeIcon = htmlElement.classList.contains('dark') ? moonIcon : sunIcon;
            activeIcon.classList.add('rotated');
            
            // Wait for a short duration before actually toggling the theme and removing the class
            setTimeout(() => {
                let newTheme;
                if (htmlElement.classList.contains('dark')) {
                    htmlElement.classList.remove('dark');
                    localStorage.setItem('theme', 'dark');
                    newTheme = 'dark';
                } else {
                    htmlElement.classList.add('dark');
                    localStorage.setItem('theme', 'light');
                    newTheme = 'light';
                }
                updateIcons(newTheme);
                activeIcon.classList.remove('rotated'); // Remove class after transition
            }, 300); // Match transition duration
        }

        // Event Listener
        themeToggle.addEventListener('click', toggleTheme);
        
        // --- Medium Integration Logic (Existing) ---

        /**
         * Fetches and displays the latest Medium posts with retry logic (Exponential Backoff).
         */
        async function fetchMediumPosts() {
            const mediumUsername = 'jakemer10'; // <--- !!! REPLACE WITH YOUR MEDIUM USERNAME !!! --->
            const rssUrl = `https://medium.com/feed/@${mediumUsername}`;
            const apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssUrl)}&api_key=`; // api_key is optional
            
            const maxRetries = 3;
            let currentRetry = 0;

            // Clear the loading message before starting the fetch process
            postsList.innerHTML = `<li class="p-4 bg-gray-50 dark:bg-secondary-dark/70 rounded-lg text-gray-500 dark:text-gray-400 italic">Loading posts from Medium... (Attempt 1)</li>`;

            while (currentRetry < maxRetries) {
                try {
                    const response = await fetch(apiUrl);
                    
                    if (!response.ok) {
                        // Throw error if response status is not 2xx
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();

                    // Check for successful data status from the proxy service itself
                    if (data.status === 'ok' && data.items.length > 0) {
                        postsList.innerHTML = ''; // Clear loading message on success
                        
                        // Filter out non-post items (like responses/comments) and only take the first 3
                        const posts = data.items
                            .filter(item => item.categories.length > 0)
                            .slice(0, 3); 

                        if (posts.length === 0) {
                            postsList.innerHTML = `<li class="p-4 text-center bg-gray-50 dark:bg-secondary-dark/70 rounded-lg text-gray-500 dark:text-gray-400 italic">No public posts found for the username: ${mediumUsername}.</li>`;
                            return; // Success (but no posts found)
                        }
                        
                        posts.forEach(post => {
                            // Extract date and format
                            const date = new Date(post.pubDate).toLocaleDateString('en-US', {
                                year: 'numeric', month: 'long', day: 'numeric'
                            });

                            const li = document.createElement('li');
                            li.className = 'p-4 bg-gray-50 dark:bg-secondary-dark/70 rounded-lg hover:bg-gray-100 dark:hover:bg-secondary-dark transition duration-300';
                            li.innerHTML = `
                                <a href="${post.link}" target="_blank" rel="noopener noreferrer" class="block font-medium text-lg text-gray-800 dark:text-text-dark hover:text-accent">${post.title}</a>
                                <span class="text-sm text-gray-500 dark:text-gray-500">${date}</span>
                            `;
                            postsList.appendChild(li);
                        });
                        return; // Success, exit the loop
                    } else if (data.status === 'error' && (data.message.includes('not found') || data.message.includes('Invalid URL'))) {
                        // Specific error handling for bad username or failed RSS parsing
                           postsList.innerHTML = `<li class="p-4 text-center bg-red-100 dark:bg-secondary-dark/70 border border-red-300 rounded-lg text-red-700 dark:text-red-400">Error: Medium username <strong>'${mediumUsername}'</strong> may be incorrect or have no public posts.</li>`;
                           return; // Permanent failure, exit
                    } else {
                        // General proxy error
                        throw new Error(`Proxy status error: ${data.message || 'Unknown status error.'}`);
                    }

                } catch (error) {
                    console.error(`Failed to fetch Medium posts (Attempt ${currentRetry + 1}):`, error);
                    currentRetry++;

                    if (currentRetry < maxRetries) {
                        // Exponential backoff
                        const delay = Math.pow(2, currentRetry) * 1000; // 2s, 4s
                        postsList.innerHTML = `<li class="p-4 bg-gray-50 dark:bg-secondary-dark/70 rounded-lg text-gray-500 dark:text-gray-400 italic">Retrying fetch in ${delay / 1000}s... (Attempt ${currentRetry + 1})</li>`;
                        await new Promise(resolve => setTimeout(resolve, delay));
                    } else {
                        // Failed all retries
                        postsList.innerHTML = `<li class="p-4 text-center bg-red-100 dark:bg-secondary-dark/70 border border-red-300 rounded-lg text-red-700 dark:text-red-400">Failed to load posts after ${maxRetries} attempts. The Medium feed or the proxy service may be temporarily unavailable.</li>`;
                    }
                }
            }
        }

        /**
         * Converts a repository slug (e.g., 'my-cool-project') into a
         * capitalized, user-friendly title (e.g., 'My Cool Project').
         * @param {string} slug The raw repository name from GitHub.
         * @returns {string} The formatted title.
         */
        function formatProjectTitle(slug) {
            if (!slug) return '';
            // 1. Replace hyphens/underscores with spaces
            // 2. Split by space, capitalize each word, and join them back
            return slug
                .replace(/[-_]/g, ' ')
                .split(' ')
                .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
                .join(' ');
        }

        // --- GitHub Integration Logic (Updated for GitHub Compliance) ---

        /**
         * Fetches GitHub repositories and filters them by the 'portfolio-feature' topic tag.
         */
        async function fetchGitHubProjects() {
            const githubUsername = 'jakemerten'; // <--- !!! REPLACE WITH YOUR GITHUB USERNAME !!! --->
            // Fetch all repos (max 100, which should cover most portfolios)
            const apiUrl = `https://api.github.com/users/${githubUsername}/repos?per_page=100`; 
            
            // Initial loading message is already set in HTML, clear filter area
            filterButtonsContainer.innerHTML = '';

            try {
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    throw new Error(`GitHub API HTTP error! status: ${response.status}`);
                }
                
                const repositories = await response.json();
                
                if (!Array.isArray(repositories) || repositories.length === 0) {
                    projectsGrid.innerHTML = `<div class="col-span-1 md:col-span-2 p-6 text-center bg-gray-50 dark:bg-secondary-dark/70 rounded-xl shadow-lg text-gray-500 dark:text-gray-400">No public repositories found for ${githubUsername}.</div>`;
                    return;
                }

                // Filter for featured projects (using the specific topic tag)
                const featuredProjects = repositories
                    .filter(repo => repo.topics && repo.topics.includes(FEATURE_TAG))
                    .sort((a, b) => new Date(b.updated_at) - new Date(a.updated_at)) // Sort featured projects by last updated date
                    .slice(0, 6); // Display maximum of 6 featured projects

                if (featuredProjects.length === 0) {
                    projectsGrid.innerHTML = `<div class="col-span-1 md:col-span-2 p-6 text-center bg-yellow-100 dark:bg-secondary-dark/70 border border-yellow-300 rounded-lg text-yellow-700 dark:text-yellow-400">Please add the GitHub topic tag <strong>'${FEATURE_TAG}'</strong> to your desired repositories to feature them here.</div>`;
                    return;
                }


                renderProjects(featuredProjects);

            } catch (error) {
                console.error("Failed to fetch GitHub projects:", error);
                projectsGrid.innerHTML = `<div class="col-span-1 md:col-span-2 p-6 text-center bg-red-100 dark:bg-secondary-dark/70 border border-red-300 rounded-lg text-red-700 dark:text-red-400">Error fetching GitHub projects. Check console for details.</div>`;
            }
        }

        function renderProjects(projects) {
            projectsGrid.innerHTML = ''; // Clear grid
            
            // 1. Collect unique topics/categories from ALL topics, excluding internal tags
            const allCategories = new Set(['All']);
            projects.forEach(p => {
                if (p.topics) {
                    p.topics.forEach(topic => {
                        // Exclude the feature tag and the new title tag
                        if (topic !== FEATURE_TAG && !topic.startsWith(TITLE_PREFIX)) {
                            allCategories.add(topic);
                        }
                    });
                }
            });

            // 2. Render Filter Buttons
            filterButtonsContainer.innerHTML = '';
            allCategories.forEach(category => {
                const button = document.createElement('button');
                // Create a clean ID for filtering (no spaces/special chars)
                const categoryId = category.toLowerCase().replace(/[^a-z0-9]/g, '');
                const isAll = category === 'All';

                button.textContent = category;
                button.dataset.filterId = categoryId; // Use data-filter-id for clarity
                // Apply 'accent' styling to 'All' by default
                button.className = `filter-btn px-4 py-2 text-sm rounded-full font-medium transition duration-200 shadow-md ${isAll ? 'bg-accent text-white' : 'bg-gray-100 dark:bg-secondary-dark text-gray-700 dark:text-text-dark hover:bg-gray-200 dark:hover:bg-gray-700'}`;
                
                button.addEventListener('click', () => applyFilter(categoryId));
                filterButtonsContainer.appendChild(button);
            });
            
            // 3. Render Project Cards
            projects.forEach(project => {
                
                // --- CUSTOM TITLE LOGIC ---
                // GitHub topics MUST be lowercase and use hyphens (e.g., 'proj-title-my-app-name')
                // This logic converts it to a clean, readable title (e.g., 'My App Name').
                let displayTitle = formatProjectTitle(project.name); // Default to formatted name
                let customTitleTopic = project.topics.find(t => t.startsWith(TITLE_PREFIX));

                if (customTitleTopic) {
                    // 1. Get the raw, hyphenated title text (e.g., "my-app-name")
                    let rawTitle = customTitleTopic.substring(TITLE_PREFIX.length).trim();
                    
                    // 2. Replace hyphens with spaces (e.g., "my app name")
                    let spacedTitle = rawTitle.replace(/-/g, ' '); 
                    
                    // 3. Capitalize the first letter of each word for clean display
                    displayTitle = spacedTitle.split(' ')
                        .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
                        .join(' ');
                }
                // --- END CUSTOM TITLE LOGIC ---

                // Get all relevant topics (excluding feature tag and title tag) as a comma-separated string
                const projectTopics = project.topics
                    .filter(t => t !== FEATURE_TAG && !t.startsWith(TITLE_PREFIX))
                    .map(t => t.toLowerCase().replace(/[^a-z0-9]/g, ''))
                    .join(','); 
                
                // For display purposes, list all remaining topics
                const topicChips = project.topics
                    .filter(t => t !== FEATURE_TAG && !t.startsWith(TITLE_PREFIX)) // Filter out internal tags
                    .map(t => `<span class="inline-flex items-center px-3 py-1 bg-accent/10 dark:bg-accent/20 text-accent font-medium rounded-full">${t}</span>`)
                    .join('');


                const card = document.createElement('div');
                // Store all clean topics in data-topics for multi-filter checking
                card.dataset.topics = projectTopics; 
                card.className = `project-card bg-gray-50 dark:bg-secondary-dark/70 p-6 rounded-xl shadow-lg hover:shadow-xl transition duration-300 transform hover:-translate-y-1`;
                card.innerHTML = `
                    <a href="${project.html_url}" target="_blank" rel="noopener noreferrer" class="group block">
                        <!-- Use the dynamically determined title -->
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-text-light group-hover:text-accent mb-2">${displayTitle}</h3>
                        <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">${project.description || 'No description provided in GitHub.'}</p>
                        <div class="flex flex-wrap items-center space-x-2 text-xs text-gray-500 dark:text-gray-400">
                            <!-- Language/Topic tags -->
                            ${topicChips}
                        </div>
                    </a>
                `;
                projectsGrid.appendChild(card);
            });
        }

        function applyFilter(filterId) {
            // Update button styling
            document.querySelectorAll('#filter-buttons .filter-btn').forEach(btn => {
                const isSelected = btn.dataset.filterId === filterId;
                if (isSelected) {
                    btn.classList.add('bg-accent', 'text-white');
                    btn.classList.remove('bg-gray-100', 'dark:bg-secondary-dark', 'text-gray-700', 'dark:text-text-dark', 'hover:bg-gray-200', 'dark:hover:bg-gray-700');
                } else {
                    btn.classList.remove('bg-accent', 'text-white');
                    btn.classList.add('bg-gray-100', 'dark:bg-secondary-dark', 'text-gray-700', 'dark:text-text-dark', 'hover:bg-gray-200', 'dark:hover:bg-gray-700');
                }
            });

            // Filter projects
            document.querySelectorAll('.project-card').forEach(card => {
                const cardTopics = card.dataset.topics; // Comma-separated string of topics (e.g., 'typescript,react')

                if (filterId === 'all' || cardTopics.includes(filterId)) {
                    // Show if 'all' is selected or if the card's topics string contains the filter ID
                    card.classList.remove('hidden');
                } else {
                    card.classList.add('hidden');
                }
            });
        }
        
        // --- Initialization ---

        window.onload = () => {
            initTheme();
            fetchGitHubProjects(); // Load projects first
            fetchMediumPosts();   // Load posts second
        };
    </script>
</body>
</html>